import"./AdminLayout.astro_astro_type_script_index_0_lang.DLKx8HaD.js";document.addEventListener("DOMContentLoaded",()=>{const v=document.getElementById("uploadForm"),f=document.getElementById("uploadBase64Form"),r=document.getElementById("imagePreviewContainer"),d=document.getElementById("imagePreview"),c=document.getElementById("imageFilePreview"),i=document.getElementById("dragText"),l=document.getElementById("uploadBase64Button"),m=document.getElementById("uploadedImages"),u=typeof window<"u"&&window.location.hostname!=="localhost"&&window.location.hostname!=="127.0.0.1"?"https://api.render.com/deploy/srv-d1j3t42dbo4c73c3oed0?key=8xmbZwA9YQo":"http://localhost:8000";let o=null;function g(a){const e=m.querySelector("p");e&&e.remove();const t=document.createElement("div");t.className="border rounded-md overflow-hidden",t.innerHTML=`
                <img src="${a}" alt="Imagen subida" class="w-full h-48 object-cover">
                <div class="p-2">
                    <div class="flex justify-between items-center">
                        <a href="${a}" target="_blank" class="text-blue-600 hover:underline text-sm">Ver imagen</a>
                        <button class="text-red-600 hover:text-red-800 text-sm">Eliminar</button>
                    </div>
                </div>
            `,m.prepend(t)}v.addEventListener("submit",async a=>{a.preventDefault();const e=document.getElementById("imageFile"),t=e.files[0];if(!t){alert("Por favor selecciona una imagen");return}const n=new FormData;n.append("file",t);try{const s=await fetch(`${u}/upload-image`,{method:"POST",body:n});if(!s.ok)throw new Error("Error al subir la imagen");const p=await s.json();g(p.url),e.value="",alert("Imagen subida correctamente")}catch(s){console.error("Error:",s),alert("Error al subir la imagen")}}),c.addEventListener("change",a=>{const e=a.target.files[0];if(e){const t=new FileReader;t.onload=n=>{o=n.target.result,d.src=o,d.classList.remove("hidden"),i.classList.add("hidden"),l.disabled=!1},t.readAsDataURL(e)}}),r.addEventListener("click",()=>{c.click()}),["dragenter","dragover","dragleave","drop"].forEach(a=>{r.addEventListener(a,e=>{e.preventDefault(),e.stopPropagation()})}),r.addEventListener("dragenter",()=>{r.classList.add("border-blue-500")}),r.addEventListener("dragleave",()=>{r.classList.remove("border-blue-500")}),r.addEventListener("drop",a=>{r.classList.remove("border-blue-500");const e=a.dataTransfer.files[0];if(e&&e.type.startsWith("image/")){const t=new FileReader;t.onload=n=>{o=n.target.result,d.src=o,d.classList.remove("hidden"),i.classList.add("hidden"),l.disabled=!1},t.readAsDataURL(e)}}),f.addEventListener("submit",async a=>{if(a.preventDefault(),!o){alert("Por favor selecciona una imagen");return}try{const e=new FormData;e.append("image_data",o);const t=await fetch(`${u}/upload-image-base64`,{method:"POST",body:e});if(!t.ok)throw new Error("Error al subir la imagen");const n=await t.json();g(n.url),d.classList.add("hidden"),i.classList.remove("hidden"),o=null,l.disabled=!0,alert("Imagen subida correctamente")}catch(e){console.error("Error:",e),alert("Error al subir la imagen")}})});
